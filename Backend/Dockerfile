FROM node:lts-alpine

ARG SERVICENAME
ARG SERVICEDIR
ARG ARG_PORT

ENV ${SERVICENAME}_PORT=$ARG_PORT

RUN mkdir -p /app/$SERVICENAME
WORKDIR /app/$SERVICENAME
COPY /$SERVICEDIR/ .
RUN npm install --unsafe-perm
EXPOSE $ARG_PORT
CMD npm run deploy